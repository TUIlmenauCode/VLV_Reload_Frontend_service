
<%- include('./parts/head.ejs',{url : url, page_title : page_title})%>

<body>

<%- include('./parts/preloader.ejs')%>    
    <div id="pcoded" class="pcoded" >
        <div class="pcoded-overlay-box"></div>
        <div class="pcoded-container navbar-wrapper">
            

        <%- include('./parts/header.ejs')%>    

        <%- include('./parts/chat_persons.ejs')%>    

        <%- include('./parts/chat.ejs')%>    

            
            <div class="pcoded-main-container">
                <div class="pcoded-wrapper">
                    
                    <%- include('./parts/side_nav.ejs')%> 
                    <div class="pcoded-content">
                        
                    <%- include('./parts/breadcrumb.ejs',{url : url , page_description : "Test" , page_title : page_title, breadcrumb : [{name : "Öffendlich", link: "/public/view"}]}) %>
                    
                        
                    
                    <div class="pcoded-inner-content full-calender">
                  <div class="main-body">
                    <div class="page-wrapper">

                      <div class="page-body">
                        <div class="card">
                          
                          <div class="card-block">
                            <div class="row">
                              <!--<div class="col-xl-2 col-md-12">
                                <div id="external-events">
                                  <h6 class="m-b-30 m-t-20">Events</h6>
                                  <div class="fc-event ui-draggable ui-draggable-handle">My Event 1</div>
                                  <div class="fc-event ui-draggable ui-draggable-handle">My Event 2</div>
                                  <div class="fc-event ui-draggable ui-draggable-handle">My Event 3</div>
                                  <div class="fc-event ui-draggable ui-draggable-handle">My Event 4</div>
                                  <div class="fc-event ui-draggable ui-draggable-handle">My Event 5</div>
                                  <div class="checkbox-fade fade-in-primary m-t-10">
                                    <label>
                                      <input type="checkbox" value="">
                                      <span class="cr">
                                        <i class="cr-icon icofont icofont-ui-check txt-primary"></i>
                                      </span>
                                      <span>Remove After Drop</span>
                                    </label>
                                  </div>
                                </div>
                              </div>-->
                              <div class="col-xl-10 col-md-12">
                                <div id='calendar'></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="page-error">
                    <div class="card text-center">
                      <div class="card-block">
                        <div class="m-t-10">
                          <i class="icofont icofont-warning text-white bg-c-yellow"></i>
                          <h4 class="f-w-600 m-t-25">Not supported</h4>
                          <p class="text-muted m-b-0">Full Calendar not supported in this device</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                    </div>
                    <!-- [ style Customizer ] start -->
                    <div id="styleSelector">
                    </div>
                    <!-- [ style Customizer ] end -->
                </div>
            </div>
        </div>
    </div>
    <%- include('./parts/foot.ejs',{url : url})%>
</body>

<link rel='stylesheet' href='<%= url %>/files/bower_components/fullcalendar-3.9.0/fullcalendar.css' />
<link rel='stylesheet' href='<%= url %>/files/assets/css/pages.css' />

<script src='<%= url %>/files/bower_components/moment/js/moment.min.js'></script>
<script src='<%= url %>/files/bower_components/fullcalendar-3.9.0/fullcalendar.js'></script>
<script src='<%= url %>/files/bower_components/fullcalendar-3.9.0/locale/de.js'></script>
<script src='<%= url %>/files/bower_components/superagent/superagent-4_1_0.js'></script>



<script>

$(document).ready(function(){
    setTimeout(function(){ showTour(); }, 800);

    $('#calendar').fullCalendar({
        header: {
            left: 'prev, today, next',
            center: 'title',
            right : ''
        },
        defaultDate: '2019-04-04',
        defaultView : 'agendaDay'
    })

    

});

function showTour(){
        var current_course;
        Swal.fire({
            input: 'select',
            confirmButtonText: 'Next &rarr;',
            showCancelButton: true,
            title: 'Akademischer Grad',
            text: 'Bitte wähle deinen angestrebten Akademischen Grad',
            inputOptions: academicDegreePromise
        }).then((result) => {
                if (result.value) {
                    console.log(result.value);
                    console.log(typeof result.value);
                    Swal.fire({
                        input: 'select',
                        confirmButtonText: 'Next &rarr;',
                        showCancelButton: true,
                        title: 'Fachsemester',
                        text: 'Bitte wähle deinen angestrebten Akademischen Grad',
                        inputOptions: CoursePromise(result.value)
                    }).then((result) => {
                            if (result.value) {
                                current_course = result.value;
                                Swal.fire({
                                    input: 'select',
                                    confirmButtonText: 'Next &rarr;',
                                    showCancelButton: true,
                                    title: 'Fachsemester',
                                    text: 'Bitte wähle deinen angestrebten Akademischen Grad',
                                    inputOptions: semesterPromise(result.value)
                                }).then((result) => {
                                        if (result.value) {
                                            Swal.fire({
                                                input: 'select',
                                                confirmButtonText: 'Next &rarr;',
                                                showCancelButton: true,
                                                title: 'Akademischer Grad',
                                                text: 'Bitte wähle deinen angestrebten Akademischen Grad',
                                                inputOptions: GroupPromise(current_course, result.value)
                                            }).then((result) => {
                                                    if (result.value) {
                                                        buildCalendar(result.value);
                                                    }
                                                })
                                        }
                                    })
                            }
                        })
                }
            })
    }

function buildCalendar(seminar_gruppe){
    Swal.fire(seminar_gruppe);
}

var academicDegreePromise = new Promise(function (resolve, reject) {
    $.ajax({
        url: "https://app.vlv-reload.de/api/AcademicDegree/get_Name_ID",
        method : "POST",
        success: function (data) {
            var returnObject = {};
            JSON.parse(data).forEach(function(e){
                returnObject[e.academicDegreeID ] = e.name ;
            })
            resolve(returnObject)
        }
    });
});

var semesterPromise_ = new Promise(function (resolve, reject) {
    $.ajax({
        url: "https://app.vlv-reload.de/api/Semester/get_Name_ID",
        method : "POST",
        success: function (data) {
            var returnObject = {};
            JSON.parse(data).forEach(function(e){
                returnObject[e.semester ] = e.name ;
            })
            resolve(returnObject)
        }
    });
});

var semesterPromise = function(course){
    return new Promise(function (resolve, reject) {
        $.ajax({
            url: "https://app.vlv-reload.de/api/Semester/get_Name_ID",
            method : "POST",
            data: {Course : course},
            success: function (data) {
                console.log(data);
                var returnObject = {};
                JSON.parse(data).forEach(function(e){
                    returnObject[e.semester ] = e.name ;
                })
                resolve(returnObject)
            },
            error: function(jqxhr, status, exception) {
             console.log( exception);
         }
        });
    });
}


var CoursePromise = function(grade){
    return new Promise(function (resolve, reject) {
        $.ajax({
            url: "https://app.vlv-reload.de/api/Course/get_Name_ID",
            type : "POST",
            data: {AcademicDegree : grade },
            success: function (data) {
                console.log(data);
                var returnObject = {};
                JSON.parse(data).forEach(function(e){
                    returnObject[e.courseID ] = e.name ;
                })
                resolve(returnObject)
            },
            error: function(jqxhr, status, exception) {
             console.log( exception);
         }
        });
    });
}

var GroupPromise = function(course, semester){
    return new Promise(function (resolve, reject) {
        $.ajax({
            url: "https://app.vlv-reload.de/api/SeminarGroup/get_Name_ID",
            type : "POST",
            data: {Semester : semester, Course:  course},
            success: function (data) {
                console.log(data);
                var returnObject = {};
                JSON.parse(data).forEach(function(e){
                    returnObject[e.seminarGroupID ] = e.name ;
                })
                resolve(returnObject)
            },
            error: function(jqxhr, status, exception) {
             console.log( exception);
         }
        });
    });
}







</script>

</html>
